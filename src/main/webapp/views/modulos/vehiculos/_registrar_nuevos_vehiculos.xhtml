<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:sec="https://joinfaces.org/security">

   <p:dialog header="Registrar nuevos vehículos"
             id="registrar-vehiculo-dialog" widgetVar="registrarVehiculoDialog"
             height="450" width="850"
             showEffect="fade" modal="true"
             closable="true" closeOnEscape="true"
             cache="false" responsive="true">
      <p:outputPanel id="registrar-vehiculo-dialog-content" styleClass="formgrid grid">

         <p:tabView id="tab-view" rendered="#{vehiculoView.showNuevoFormDialog}">
            <p:tab id="registro-individual" title="Registro individual">

               <h:form id="individual-form" styleClass="formgrid grid">

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Dependencia" styleClass="block"/>
                     <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependencia.idDependencia}"
                                      styleClass="w-full mw-auto" required="true">
                        <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                       itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="No. Serie" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.noSerie}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Placa" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  onkeyup="Validator.validateInputTextCode(this);"
                                  value="#{vehiculoView.vehiculoSelected.placa}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Marca" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  placeholder="Ej. Nissan"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.marca}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Modelo" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  placeholder="Ej. Altima"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.modelo}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Año" styleClass="block"/>
                     <p:inputNumber styleClass="block w-full" required="true"
                                    placeholder="Ej. 2022"
                                    value="#{vehiculoView.vehiculoSelected.anio}"
                                    decimalSeparator="" thousandSeparator="" symbol=""/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="No. Motor" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.noMotor}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Color" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  placeholder="Ej. Rojo"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.color}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Condición" styleClass="block"/>
                     <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.condicionVehiculo.idCondicionVehiculo}"
                                      styleClass="w-full mw-auto" required="true">
                        <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.condicionVehiculoList}" var="condicionVehiculo"
                                       itemValue="#{condicionVehiculo.idCondicionVehiculo}" itemLabel="#{condicionVehiculo.nombre}"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="No. Factura" styleClass="block"/>
                     <p:inputText styleClass="block w-full" required="true"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.noFactura}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Valor factura" styleClass="block"/>
                     <p:inputNumber styleClass="block w-full" required="true"
                                    value="#{vehiculoView.vehiculoSelected.montoFactura}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Renta mensual" styleClass="block"/>
                     <p:inputNumber styleClass="block w-full" required="true"
                                    value="#{vehiculoView.vehiculoSelected.rentaMensual}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12">
                     <p:outputLabel for="@next" value="Descripción" styleClass="block"/>
                     <p:inputTextarea styleClass="block w-full" rows="2"  autoResize="true"
                                      onkeyup="Validator.validateInputTextArea(this);"
                                      value="#{vehiculoView.vehiculoSelected.descripcionVehiculo}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Licitación" styleClass="block"/>
                     <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.licitacion.idLicitacion}"
                                      styleClass="w-full mw-auto">
                        <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.licitacionFormList}" var="licitacion"
                                       itemValue="#{licitacion.idLicitacion}" itemLabel="#{licitacion.numeroLicitacion}"/>
                        <p:ajax event="change" listener="#{vehiculoView.onChangeLicitacionForm()}" update="individual-form:select_anexo"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Anexo" styleClass="block"/>
                     <p:selectOneMenu id="select_anexo" value="#{vehiculoView.vehiculoSelected.anexo.idAnexo}"
                                      styleClass="w-full mw-auto">
                        <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.anexoFormList}" var="anexo"
                                       itemValue="#{anexo.idAnexo}" itemLabel="#{anexo.nombre}"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Dependencia asignada" styleClass="block"/>
                     <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependenciaAsignada.idDependencia}"
                                      styleClass="w-full mw-auto">
                        <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                       itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Reguardante" styleClass="block"/>
                     <p:inputText styleClass="block w-full"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.resguardante}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Área reguardante" styleClass="block"/>
                     <p:inputText styleClass="block w-full"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.areaResguardante}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Proveedor" styleClass="block"/>
                     <p:inputText styleClass="block w-full"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.proveedor}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Director Administrativo" styleClass="block"/>
                     <p:inputText styleClass="block w-full"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.autorizaDirectorAdmin}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                     <p:outputLabel for="@next" value="Director General" styleClass="block"/>
                     <p:inputText styleClass="block w-full"
                                  onkeyup="Validator.validateInputText(this);"
                                  value="#{vehiculoView.vehiculoSelected.autorizaDirectorGeneral}"/>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 mt-5 mb-0">

                     <p:outputPanel styleClass="flex justify-content-end">
                        <p:commandButton value="Cancelar" ajax="true" process="@this"
                                         action="#{vehiculoView.cerrarModalRegistroVehiculo()}"
                                         styleClass="ui-button-outlined mr-4"/>
                        <p:commandButton value="Guardar" ajax="true" process="@form"
                                         action="#{vehiculoView.guardarNuevoVehiculo()}"
                                         update="growl @form form_datatable"
                                         validateClient="true"/>
                     </p:outputPanel>

                  </p:outputPanel>

               </h:form>

            </p:tab>
            <p:tab id="registro-layout" title="Importar layout">

               <h:form id="layout-form" styleClass="formgrid grid">

                  <p:outputPanel styleClass="field col-12" rendered="#{not vehiculoView.showErrorImportacion}">
                     <p:outputLabel for="@next" value="Dependencia" styleClass="block"/>
                     <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependencia.idDependencia}"
                                      styleClass="w-full mw-auto" required="true">
                        <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                        <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                       itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                     </p:selectOneMenu>
                     <span class="text-sm hidden"> </span>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 mb-5" rendered="#{not vehiculoView.showErrorImportacion}">
                     <p:outputLabel for="@next" value="Importar layout" styleClass="block"/>
                     <p:inputTextarea id="dropZoneLayout" widgetVar="dropZoneLayout"
                                      styleClass="w-full dropzone mb-3" rows="5" required="true"
                                      placeholder="Arrastra y suelta aquí el archivo de importación de vehículos"
                                      value="#{vehiculoView.layoutFileUpload}" readonly="true"/>
                     <span class="text-sm">
                                    <p:link value="O haz clic aquí para elegir" onclick="PF('uploadLayout').show();return false"/>
                                </span>
                     <p:fileUpload widgetVar="uploadLayout" listener="#{vehiculoView.importarLayout}"
                                   fileLimit="1" fileLimitMessage="Solo se permite subir un archivo"
                                   sizeLimit="50000000" allowTypes="/(\.|\/)(xlsx|)$/" accept=".xlsx" dropZone="dropZoneLayout"
                                   update="growl" style="display: none"/>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 mb-5" rendered="#{vehiculoView.showErrorImportacion}">
                     <p:dataTable var="acuse" value="#{vehiculoView.acuseImportacionList}"
                                  rows="25" rowHover="true"
                                  rowIndexVar="index"
                                  styleClass="dt-scrollable-x"
                                  scrollable="true" scrollHeight="230" size="small"
                                  paginator="true" paginatorPosition="bottom"
                                  paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                  currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                  rowsPerPageTemplate="25,100,200,{ShowAll|'Todos'}">
                        <f:facet name="header">
                           Se encontraron errores al importar el layout
                        </f:facet>

                        <p:column headerText="Vehículo" width="180">
                           <h:outputText value="#{acuse.titulo}"/>
                        </p:column>

                        <p:column headerText="Error" style="min-width: 200px">
                           <h:outputText value="#{acuse.mensaje}"/>
                        </p:column>

                     </p:dataTable>
                  </p:outputPanel>

                  <p:outputPanel styleClass="field col-12 mt-5 mb-0" rendered="#{not vehiculoView.showErrorImportacion}">
                     <p:outputPanel styleClass="flex justify-content-end">
                        <p:commandButton value="Cancelar" ajax="true" process="@this"
                                         action="#{vehiculoView.cerrarModalRegistroVehiculo()}"
                                         styleClass="ui-button-outlined mr-4"/>
                        <p:commandButton value="Guardar" ajax="true" process="@form"
                                         action="#{vehiculoView.guardarImportacionVehiculo()}"
                                         update="growl @form form_datatable"
                                         validateClient="true"/>
                     </p:outputPanel>
                  </p:outputPanel>
               </h:form>
            </p:tab>
         </p:tabView>
      </p:outputPanel>
   </p:dialog>

</ui:composition>
