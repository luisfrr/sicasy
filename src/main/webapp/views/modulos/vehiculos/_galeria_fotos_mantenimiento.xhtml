<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:p="http://primefaces.org/ui">

   <h:form id="form_galeria_mantenimiento" enctype="multipart/form-data">
      <p:dialog header="Fotos de los mantenimientos" widgetVar="galeriaFotosMantenimientoDialog" styleClass="mb-5"
                minWidth="600"
                showEffect="fade" modal="true"
                cache="false" responsive="true">

         <p:panel rendered="#{empty vehiculoView.mantenimientoFotoList}">
            <p:outputLabel>No se han cargado fotos todavía</p:outputLabel>
            <p:commandLink styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default flex justify-content-center align-items-center"
                           ajax="true" action="#{vehiculoView.abrirModalAdjuntarFotos(vehiculoView.vehiculoSelected.idVehiculo)}"
                           oncomplete="Main.changeChooseLabel();" update="growl">
               <i class="fi fi-rr-add-image"/>
            </p:commandLink>
         </p:panel>

         <p:galleria value="#{vehiculoView.mantenimientoFotoList}" var="mantenimientoFoto" numVisible="5"
                     widgetVar="mantenimientoFotoGaleria"
                     rendered="#{vehiculoView.mantenimientoFotoList.size() > 0}"
                     responsiveOptions="#{vehiculoView.responsiveOptions}"
                     circular="true" autoPlay="true" transitionInterval="5000"
                     showCaption="true" style="max-width: 600px">
            <p:graphicImage value="#{fileBean.getFile(mantenimientoFoto.rutaArchivo)}" alt="#{mantenimientoFoto.nombreArchivo}"
                            style="width: 100%; display: block;" stream="false" />
            <f:facet name="caption">
               <h5 class="mb-2 text-white">#{mantenimientoFoto.nombreArchivo}</h5>
               <p:outputPanel class="flex justify-content-between align-items-center">
                  <p class="text-white">#{mantenimientoFoto.fechaCreacion}</p>
                  <p:commandLink styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default flex justify-content-center align-items-center"
                                 ajax="true" action="#{vehiculoView.borrarFotoMantenimiento(mantenimientoFoto.idMantenimientoFoto)}">
                     <i class="fi fi-rr-trash text-xl text-white"/>
                  </p:commandLink>
               </p:outputPanel>
            </f:facet>
            <f:facet name="thumbnail">
               <p:graphicImage value="#{fileBean.getFile(mantenimientoFoto.rutaArchivo)}" alt="#{mantenimientoFoto.nombreArchivo}"
                               style="height: 100px; width: auto; display: block" stream="false" />
            </f:facet>
         </p:galleria>
      </p:dialog>
   </h:form>

   <h:form id="form_adjuntar_fotos-mantenimiento">

      <p:dialog header="Adjuntar fotos"
                id="adjuntar-fotos-dialog-mantenimiento" widgetVar="adjuntarFotosMantenimientoDialog"
                height="450" width="800"
                showEffect="fade" modal="true"
                closable="false" closeOnEscape="false"
                cache="false" responsive="true">

         <p:outputPanel id="adjuntar-fotos-dialog-content" styleClass="formgrid grid">

            <p:outputPanel styleClass="field col-12 mb-5">
               <p:fileUpload listener="#{vehiculoView.subirFotoMantenimiento2}" mode="advanced" dragDropSupport="true"
                             chooseButtonTitle="Elegir" chooseLabel="Elegir"
                             cancelButtonTitle="Cancelar" cancelLabel="Cancelar"
                             uploadButtonTitle="Subir" uploadLabel="Subir"
                             multiple="true" update="growl" sizeLimit="10000000" fileLimit="10"
                             fileLimitMessage="Has superado el número máximo de archivos"
                             invalidFileMessage="Archivo no válido"
                             invalidSizeMessage="Has superado el tamaño máximo por archivo"
                             accept=".jpg,.jpeg,.png">
               </p:fileUpload>
               <span class="text-sm">Sólo se permiten archivos .jpg, .jpeg y .png. Máximo 10 archivos</span>
            </p:outputPanel>

            <p:outputPanel styleClass="field col-12 mb-0">

               <p:outputPanel styleClass="flex justify-content-end">
                  <p:commandButton value="Cerrar" ajax="true" process="@this"
                                   action="#{vehiculoView.cerrarGaleriaFotosMantenimiento()}"
                                   styleClass="ui-button-outlined"/>
               </p:outputPanel>

            </p:outputPanel>

         </p:outputPanel>

      </p:dialog>

   </h:form>

</ui:composition>
