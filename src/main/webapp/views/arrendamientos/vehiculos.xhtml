<ui:composition template="../../WEB-INF/facelets/main_layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:sec="https://joinfaces.org/security">

<ui:define name="title">
    #{vehiculoView.title}
</ui:define>

<ui:define name="content">

    <p:outputPanel id="container" styleClass="container-fluid">

        <p:growl id="growl" showDetail="true" showSummary="true"
                 skipDetailIfEqualsSummary="true" globalOnly="true"/>

        <p:outputPanel id="panel_vehiculos">

            <h:form id="form_breadcum" styleClass="mb-3">
                <p:breadCrumb homeDisplay="text">
                    <p:menuitem value="Inicio" ajax="false" action="#{menuSessionBean.goToHome()}"/>
                    <p:menuitem value="Vehículos"/>
                </p:breadCrumb>
            </h:form>

            <h:form id="form_toolbar" styleClass="mb-5">
                <sec:authorize access="hasAnyAuthority('ROLE_OWNER')">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <sec:authorize access="hasAnyAuthority('ROLE_OWNER')">
                                <p:commandButton id="btn_acciones_vehiculos" type="button" value="Acciones"
                                                 iconPos="right" icon="fi fi-rr-angle-small-down"/>
                                <p:menu overlay="true" trigger="btn_acciones_vehiculos" my="left top" at="left bottom">
                                    <p:menuitem value="Registrar nuevos vehículos" ajax="true" action="#{vehiculoView.abrirModalRegistroVehiculo()}"/>
                                    <p:menuitem value="Solicitar autorización"/>
                                    <p:menuitem value="Autorizar solicitud"/>
                                    <p:menuitem value="Rechazar solicitud"/>
                                    <p:menuitem value="Cancelar solicitud"/>
                                </p:menu>
                            </sec:authorize>
                        </p:toolbarGroup>
                        <p:toolbarGroup align="right">
                            <p:commandButton value="Descargar Layout de Vehículos"
                                             ajax="false" onclick="PrimeFaces.monitorDownload(start, stop);"
                                             icon="fi fi-rr-download" styleClass="ui-button-flat">
                                <p:fileDownload value="#{fileDownloadBean.downloadFileByPath(vehiculoView.LAYOUT_VEHICULOS)}"/>
                            </p:commandButton>
                        </p:toolbarGroup>
                    </p:toolbar>
                </sec:authorize>
            </h:form>

            <h:form id="form_filtros" styleClass="mb-5">
                <p:panel header="Filtros" widgetVar="panelFiltros"
                         toggleable="true" toggleSpeed="500">

                    <p:outputPanel id="filtros" styleClass="formgrid grid mb-2">
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Dependencia" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.dependencia.idDependencia}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                               itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Condición" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.condicionVehiculo.idCondicionVehiculo}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.condicionVehiculoList}" var="condicionVehiculo"
                                               itemValue="#{condicionVehiculo.idCondicionVehiculo}" itemLabel="#{condicionVehiculo.nombre}"/>
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Estatus" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.estatusVehiculo.idEstatusVehiculo}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.estatusVehiculoList}" var="estatusVehiculo"
                                               itemValue="#{estatusVehiculo.idEstatusVehiculo}" itemLabel="#{estatusVehiculo.nombre}"/>
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Licitación" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.licitacion.idLicitacion}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.licitacionList}" var="licitacion"
                                               itemValue="#{licitacion.idLicitacion}" itemLabel="#{licitacion.numeroLicitacion}"/>
                                <p:ajax event="change" listener="#{vehiculoView.onChangeLicitacionFilter()}" update="form_filtros:filtros" />
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Anexo" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.anexo.idAnexo}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.anexoList}" var="anexo"
                                               itemValue="#{anexo.idAnexo}" itemLabel="#{anexo.nombre}"/>
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Marca" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.marca}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.marcaList}" var="marca"
                                               itemValue="#{marca}" itemLabel="#{marca}"/>
                                <p:ajax event="change" listener="#{vehiculoView.onChangeMarcaFilter()}" update="form_filtros:filtros" />
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>

                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Modelo" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.marca}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.modeloList}" var="modelo"
                                               itemValue="#{modelo}" itemLabel="#{modelo}"/>
                                <p:ajax event="change" listener="#{vehiculoView.onChangeModeloFilter()}" update="form_filtros:filtros" />
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>

                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="Tipo" styleClass="block"/>
                            <p:selectOneMenu value="#{vehiculoView.vehiculoFilter.anio}" styleClass="w-full mw-auto">
                                <f:selectItem itemLabel="Todos" itemValue="#{null}"/>
                                <f:selectItems value="#{vehiculoView.anioList}" var="anio"
                                               itemValue="#{anio}" itemLabel="#{anio}"/>
                            </p:selectOneMenu>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>

                        <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4 xl:col-3">
                            <p:outputLabel for="@next" value="No. Serie" styleClass="block"/>
                            <p:inputText styleClass="block w-full" placeholder="Ingresa el número de serie..."
                                         value="#{vehiculoView.vehiculoFilter.noSerie}"/>
                            <span class="text-sm hidden"> </span>
                        </p:outputPanel>
                    </p:outputPanel>
                    <f:facet name="footer">
                        <p:outputPanel styleClass="flex flex-row gap-4 justify-content-end">
                            <p:commandButton value="Limpiar filtros" styleClass="ui-button-outlined"
                                             ajax="true" action="#{vehiculoView.limpiarFiltros()}"
                                             update="form_filtros form_datatable"/>
                            <p:commandButton value="Buscar" ajax="true" action="#{vehiculoView.buscar()}"
                                             update="form_datatable"/>
                        </p:outputPanel>
                    </f:facet>
                </p:panel>
            </h:form>

            <h:form id="form_datatable" styleClass="mb-5">

                <p:dataTable id="dt_vehiculos"
                             var="vehiculo" value="#{vehiculoView.vehiculoList}"
                             rows="50" rowHover="true"
                             rowKey="#{vehiculo.idVehiculo}" rowIndexVar="index"
                             styleClass="dt-scrollable-x"
                             scrollable="true"
                             paginator="true" paginatorPosition="bottom"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                             rowsPerPageTemplate="50,100,200,{ShowAll|'Todos'}">

                    <f:facet name="header">
                        Vehículos
                    </f:facet>

                    <p:column headerText="No." width="40">
                        <h:outputText value="#{index + 1}" />
                    </p:column>

                    <p:column headerText="No. Serie" width="150">
                        <h:outputText value="#{vehiculo.noSerie}"/>
                    </p:column>

                    <p:column headerText="Marca" width="150">
                        <h:outputText value="#{vehiculo.marca}"/>
                    </p:column>

                    <p:column headerText="Modelo" width="150">
                        <h:outputText value="#{vehiculo.modelo}"/>
                    </p:column>

                    <p:column headerText="Tipo" width="150">
                        <h:outputText value="#{vehiculo.anio}"/>
                    </p:column>

                    <p:column headerText="Color" width="100">
                        <h:outputText value="#{vehiculo.color}"/>
                    </p:column>

                    <p:column headerText="Condición" width="100" styleClass="text-center">
                        <h:outputText value="#{vehiculo.condicionVehiculo.nombre}"/>
                    </p:column>

                    <p:column headerText="Estatus" width="100" styleClass="text-center">
                        <h:outputText value="#{vehiculo.estatusVehiculo.nombre}"/>
                    </p:column>

                    <p:column headerText="Dependencia" width="150" styleClass="text-center">
                        <h:outputText value="#{vehiculo.dependencia.abreviatura}"/>
                    </p:column>

                    <p:column headerText="Dependencia asig." width="150" styleClass="text-center">
                        <h:outputText value="#{vehiculo.dependenciaAsignada != null ? vehiculo.dependenciaAsignada.abreviatura : ''}"/>
                    </p:column>

                    <p:column headerText="Licitación" width="150" styleClass="text-center">
                        <h:outputText value="#{vehiculo.licitacion != null ? vehiculo.licitacion.numeroLicitacion : ''}"/>
                    </p:column>

                    <p:column headerText="Anexo" width="150">
                        <h:outputText value="#{vehiculo.anexo != null ? vehiculo.anexo.nombre : ''}"/>
                    </p:column>

                    <p:column headerText="Renta Mensual" width="150">
                        <h:outputText value="#{vehiculo.rentaMensual}">
                            <f:convertNumber maxFractionDigits="2"/>
                        </h:outputText>
                    </p:column>

                    <sec:authorize access="hasAuthority('ROLE_OWNER')">

                        <p:column headerText="Fecha creación" width="150">
                            <h:outputText value="#{vehiculo.estatusRegistro.label}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Fecha creación" width="150">
                            <h:outputText value="#{vehiculo.fechaCreacion}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Creado por" width="150">
                            <h:outputText value="#{vehiculo.creadoPor}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Fecha modificación" width="150">
                            <h:outputText value="#{vehiculo.fechaModificacion}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Modificado por" width="150">
                            <h:outputText value="#{vehiculo.modificadoPor}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Fecha borrado" width="150">
                            <h:outputText value="#{vehiculo.fechaBorrado}">
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Borrado por" width="150">
                            <h:outputText value="#{vehiculo.borradoPor}">
                            </h:outputText>
                        </p:column>

                    </sec:authorize>

                    <sec:authorize access="hasAnyAuthority('ROLE_OWNER','SEGURIDAD_ROLES_READ_CONFIGURAR_PERMISOS', 'SEGURIDAD_ROLES_WRITE_EDITAR', 'SEGURIDAD_ROLES_WRITE_ELIMINAR')">
                        <p:column headerText="Acciones" width="120">

                            <p:commandButton id="buttonOptions" type="button"
                                             icon="fi fi-rr-menu-dots-vertical"
                                             styleClass="rounded-button ui-button-outlined"
                                             rendered="#{vehiculo.estatusRegistro.label != 'Borrado'}"/>
                            <p:menu overlay="true" trigger="buttonOptions" my="left top" at="left bottom" styleClass="w-16rem">

                                <sec:authorize access="hasAnyAuthority('ROLE_OWNER')">
                                    <p:menuitem value="Ver detalle del vehículo"
                                                action="#{vehiculoView.verDetalle(vehiculo)}"
                                                ajax="true" update="container"/>
                                </sec:authorize>

                                <sec:authorize access="hasAnyAuthority('ROLE_OWNER')">
                                    <p:menuitem value="Registrar mantenimiento"
                                                ajax="true" action="#{vehiculoView.abrirModalRegistroMantenimiento(vehiculo.idVehiculo)}"
                                                update="growl form_datatable">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea restablecer la contraseña del vehiculo?" icon="pi pi-exclamation-triangle"/>
                                    </p:menuitem>
                                </sec:authorize>

                                <sec:authorize access="hasAnyAuthority('ROLE_OWNER')">
                                    <p:menuitem value="Adjuntar fotos"
                                                ajax="true" action="#{vehiculoView.abrirModalAdjuntarFotos(vehiculo.idVehiculo)}"
                                                update="growl form_datatable">
                                    </p:menuitem>
                                </sec:authorize>

                            </p:menu>

                        </p:column>
                    </sec:authorize>

                </p:dataTable>

            </h:form>

        </p:outputPanel>

        <p:dialog header="Registrar nuevos vehículos"
                  id="registrar-vehiculo-dialog" widgetVar="registrarVehiculoDialog"
                  height="450" width="850"
                  showEffect="fade" modal="true"
                  closable="true" closeOnEscape="true"
                  cache="false" responsive="true">

            <p:outputPanel id="registrar-vehiculo-dialog-content" styleClass="formgrid grid">

                <p:tabView id="tab-view" rendered="#{vehiculoView.showNuevoFormDialog}">
                    <p:tab id="registro-individual" title="Registro individual">

                        <h:form id="individual-form" styleClass="formgrid grid">

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Dependencia" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependencia.idDependencia}"
                                                 styleClass="w-full mw-auto" required="true">
                                    <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                                   itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="No. Serie" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                             value="#{vehiculoView.vehiculoSelected.noSerie}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Placa" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                             value="#{vehiculoView.vehiculoSelected.placa}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Marca" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                             placeholder="Ej. Nissan"
                                             value="#{vehiculoView.vehiculoSelected.marca}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Modelo" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                             placeholder="Ej. Altima"
                                             value="#{vehiculoView.vehiculoSelected.modelo}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Año" styleClass="block"/>
                                <p:inputNumber styleClass="block w-full" required="true"
                                             placeholder="Ej. 2022"
                                             value="#{vehiculoView.vehiculoSelected.anio}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="No. Motor" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                               value="#{vehiculoView.vehiculoSelected.noMotor}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Color" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                               placeholder="Ej. Rojo"
                                               value="#{vehiculoView.vehiculoSelected.color}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Condición" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.condicionVehiculo.idCondicionVehiculo}"
                                                 styleClass="w-full mw-auto" required="true">
                                    <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.condicionVehiculoList}" var="condicionVehiculo"
                                                   itemValue="#{condicionVehiculo.idCondicionVehiculo}" itemLabel="#{condicionVehiculo.nombre}"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="No. Factura" styleClass="block"/>
                                <p:inputText styleClass="block w-full" required="true"
                                             value="#{vehiculoView.vehiculoSelected.noFactura}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Valor factura" styleClass="block"/>
                                <p:inputNumber styleClass="block w-full" required="true"
                                             value="#{vehiculoView.vehiculoSelected.montoFactura}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Renta mensual" styleClass="block"/>
                                <p:inputNumber styleClass="block w-full" required="true"
                                               value="#{vehiculoView.vehiculoSelected.rentaMensual}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12">
                                <p:outputLabel for="@next" value="Descripción" styleClass="block"/>
                                <p:inputTextarea styleClass="block w-full" rows="2"  autoResize="true"
                                             value="#{vehiculoView.vehiculoSelected.descripcionVehiculo}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Licitación" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.licitacion.idLicitacion}"
                                                 styleClass="w-full mw-auto">
                                    <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.licitacionFormList}" var="licitacion"
                                                   itemValue="#{licitacion.idLicitacion}" itemLabel="#{licitacion.numeroLicitacion}"/>
                                    <p:ajax event="change" listener="#{vehiculoView.onChangeLicitacionForm()}" update="registrar-vehiculo-dialog-content"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Anexo" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.anexo.idAnexo}"
                                                 styleClass="w-full mw-auto">
                                    <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.anexoFormList}" var="anexo"
                                                   itemValue="#{anexo.idAnexo}" itemLabel="#{anexo.nombre}"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Dependencia asignada" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependenciaAsignada.idDependencia}"
                                                 styleClass="w-full mw-auto">
                                    <f:selectItem itemLabel="Seleccione una..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                                   itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Reguardante" styleClass="block"/>
                                <p:inputText styleClass="block w-full"
                                             value="#{vehiculoView.vehiculoSelected.resguardante}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Área reguardante" styleClass="block"/>
                                <p:inputText styleClass="block w-full"
                                             value="#{vehiculoView.vehiculoSelected.areaResguardante}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 md:col-6 lg:col-4">
                                <p:outputLabel for="@next" value="Proveedor" styleClass="block"/>
                                <p:inputText styleClass="block w-full"
                                             value="#{vehiculoView.vehiculoSelected.proveedor}"/>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 mt-5 mb-0">

                                <p:outputPanel styleClass="flex justify-content-end">
                                    <p:commandButton value="Cancelar" ajax="true" process="@this"
                                                     action="#{vehiculoView.cerrarModalRegistroVehiculo()}"
                                                     styleClass="ui-button-outlined mr-4"/>
                                    <p:commandButton value="Guardar" ajax="true" process="@form"
                                                     action="#{vehiculoView.guardarNuevoVehiculo()}"
                                                     update="growl @form form_datatable"
                                                     validateClient="true"/>
                                </p:outputPanel>

                            </p:outputPanel>

                        </h:form>

                    </p:tab>
                    <p:tab id="registro-layout" title="Importar layout">

                        <h:form id="layout-form" styleClass="formgrid grid">

                            <p:outputPanel styleClass="field col-12" rendered="#{not vehiculoView.showErrorImportacion}">
                                <p:outputLabel for="@next" value="Dependencia" styleClass="block"/>
                                <p:selectOneMenu value="#{vehiculoView.vehiculoSelected.dependencia.idDependencia}"
                                                 styleClass="w-full mw-auto" required="true">
                                    <f:selectItem itemLabel="Seleccione uno..." itemValue="#{null}"/>
                                    <f:selectItems value="#{vehiculoView.dependenciaList}" var="dependencia"
                                                   itemValue="#{dependencia.idDependencia}" itemLabel="#{dependencia.abreviatura} - #{dependencia.nombre}"/>
                                </p:selectOneMenu>
                                <span class="text-sm hidden"> </span>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 mb-5" rendered="#{not vehiculoView.showErrorImportacion}">
                                <p:outputLabel for="@next" value="Importar layout" styleClass="block"/>
                                <p:inputTextarea id="dropZoneLayout" widgetVar="dropZoneLayout"
                                                 styleClass="w-full dropzone mb-3" rows="5" required="true"
                                                 placeholder="Arrastra y suelta aquí el archivo de importación de vehículos"
                                                 value="#{vehiculoView.layoutFileUpload}" readonly="true"/>
                                <span class="text-sm">
                                    <p:link value="O haz clic aquí para elegir" onclick="PF('uploadLayout').show();return false"/>
                                </span>
                                <p:fileUpload widgetVar="uploadLayout" listener="#{vehiculoView.importarLayout}"
                                              fileLimit="1" fileLimitMessage="Solo se permite subir un archivo"
                                              sizeLimit="50000000" allowTypes="/(\.|\/)(xlsx|)$/" dropZone="dropZoneLayout"
                                              update="growl" style="display: none"/>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 mb-5" rendered="#{vehiculoView.showErrorImportacion}">
                                <p:dataTable var="acuse" value="#{vehiculoView.acuseImportacionList}"
                                             rows="25" rowHover="true"
                                             rowIndexVar="index"
                                             styleClass="dt-scrollable-x"
                                             scrollable="true" scrollHeight="230" size="small"
                                             paginator="true" paginatorPosition="bottom"
                                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                             rowsPerPageTemplate="25,100,200,{ShowAll|'Todos'}">
                                    <f:facet name="header">
                                        Se encontraron error al importar el layout
                                    </f:facet>

                                    <p:column headerText="Vehículo" width="180">
                                        <h:outputText value="#{acuse.titulo}"/>
                                    </p:column>

                                    <p:column headerText="Error" style="min-width: 200px">
                                        <h:outputText value="#{acuse.mensaje}"/>
                                    </p:column>

                                </p:dataTable>
                            </p:outputPanel>

                            <p:outputPanel styleClass="field col-12 mt-5 mb-0" rendered="#{not vehiculoView.showErrorImportacion}">
                                <p:outputPanel styleClass="flex justify-content-end">
                                    <p:commandButton value="Cancelar" ajax="true" process="@this"
                                                     action="#{vehiculoView.cerrarModalRegistroVehiculo()}"
                                                     styleClass="ui-button-outlined mr-4"/>
                                    <p:commandButton value="Guardar" ajax="true" process="@form"
                                                     action="#{vehiculoView.guardarImportacionVehiculo()}"
                                                     update="growl @form form_datatable"
                                                     validateClient="true"/>
                                </p:outputPanel>
                            </p:outputPanel>
                        </h:form>
                    </p:tab>
                </p:tabView>
            </p:outputPanel>
        </p:dialog>

    </p:outputPanel>

</ui:define>

</ui:composition>
